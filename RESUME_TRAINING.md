# Продолжение обучения модели

## Текущее состояние

Обучение было остановлено на **15-й эпохе**. Доступны следующие чекпоинты:

- `training_results/run_default_15ep2/weights/last.pt` - последний чекпоинт (эпоха 15)
- `training_results/run_default_15ep2/weights/best.pt` - лучшая модель по метрикам
- `training_results/run_default_15ep2/weights/epoch10.pt` - чекпоинт 10-й эпохи

## Способ 1: Использование готового скрипта (рекомендуется)

```bash
./resume_training.sh
```

По умолчанию скрипт продолжит обучение до **45 эпох** (еще 30 эпох после 15-й).

Чтобы указать другое общее количество эпох:

```bash
# Например, обучить до 60 эпох (еще 45 после 15-й)
./resume_training.sh 60
```

## Способ 2: Запуск вручную

```bash
cd project_yolo

python train.py \
    --data ../merged_dataset/dataset.yaml \
    --resume ../training_results/run_default_15ep2/weights/last.pt \
    --epochs 45 \
    --imgsz 640 \
    --batch 1 \
    --project ../training_results \
    --name run_default_15ep2_continued \
    --config configs/training.yaml
```

## Важные замечания

1. **Параметр `--epochs`**: При использовании `--resume` это означает **ОБЩЕЕ** количество эпох, до которого нужно обучить модель.
   - Если обучение остановилось на 15-й эпохе
   - И вы хотите обучить еще 30 эпох
   - Укажите `--epochs 45` (15 + 30)

2. **Продолжение после завершенного обучения**: Если обучение было завершено (например, 15/15 эпох), Ultralytics YOLO не может продолжить с `resume=True`. В этом случае скрипт автоматически начнет новое обучение с весами из чекпоинта. Обучение начнется с эпохи 0, но с весами, обученными на 15 эпохах. Это нормальное поведение для продолжения обучения после завершенного цикла.

3. **Имя запуска**: Скрипт использует имя `run_default_15ep2_continued` для отдельного трека результатов. Если хотите продолжить в той же директории, используйте `--name run_default_15ep2`.

4. **Чекпоинт**: Рекомендуется использовать `last.pt` для продолжения обучения, так как он содержит состояние оптимизатора и другие параметры, необходимые для корректного продолжения.

## Проверка результатов

После запуска обучения результаты будут сохранены в:
- `training_results/run_default_15ep2_continued/weights/` - чекпоинты
- `training_results/run_default_15ep2_continued/results.csv` - метрики по эпохам
- `training_results/run_default_15ep2_continued/*.png` - графики обучения

## Мониторинг обучения

Во время обучения вы увидите:
- Прогресс по эпохам
- Метрики (precision, recall, mAP)
- Loss функции
- Learning rate

Обучение автоматически сохраняет:
- `last.pt` - последний чекпоинт после каждой эпохи
- `best.pt` - лучшая модель по метрикам
- Периодические чекпоинты (согласно `save_period` в конфиге)

